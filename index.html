<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Merchant Redemption</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body { font-family: Arial; background:#f5f7fb; padding:40px; }

.card {
  max-width:500px;
  margin:auto;
  background:white;
  padding:25px;
  border-radius:14px;
}

input, select {
  width:100%;
  padding:12px;
  margin-top:8px;
}

button {
  width:100%;
  padding:14px;
  margin-top:16px;
  background:black;
  color:white;
  border:none;
}
</style>

</head>

<body>

<div class="card">

<h2>Merchant Redemption</h2>

<button id="logoutBtn">Logout</button>

<label>Member Number</label>
<input id="memberNumber">

<label>Original Bill</label>
<input id="original" type="number">

<label>Discount Type</label>
<select id="discountType">
  <option value="eur">â‚¬ Amount</option>
  <option value="percent">% Percentage</option>
</select>

<label>Discount Value</label>
<input id="discountValue" type="number">

<label>Final Bill</label>
<input id="final" type="number" disabled>

<button id="submitBtn">Submit Redemption</button>

<div id="result"></div>

</div>

<script>

// =====================
// JS LOAD TEST
// =====================

alert("JS LOADED SUCCESSFULLY");

// =====================
// SUPABASE INIT
// =====================

const supabase = window.supabase.createClient(
  "https://wyzwjfaiggymxfjkrfuq.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind5endqZmFpZ2d5bXhmamtyZnVxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAyMDc2MTIsImV4cCI6MjA4NTc4MzYxMn0.oPzAaijIIKls2fUYqPk3cvkegSPN8Iu9h8xnnZkg1JE"
);

// =====================
// BUTTON TEST LISTENERS
// =====================

document.getElementById("logoutBtn").addEventListener("click", () => {
  alert("Logout button works");
});

document.getElementById("submitBtn").addEventListener("click", () => {
  alert("Submit button works");
});

// =====================
// FINAL BILL CALC TEST
// =====================

function calculateFinal() {

  const original = Number(document.getElementById("original").value);
  const discountValue = Number(document.getElementById("discountValue").value);
  const type = document.getElementById("discountType").value;

  if (!original || !discountValue) return;

  let final;

  if (type === "percent") {
    final = original - (original * discountValue / 100);
  } else {
    final = original - discountValue;
  }

  if (final < 0) final = 0;

  document.getElementById("final").value = final.toFixed(2);
}

document.getElementById("original").addEventListener("input", calculateFinal);
document.getElementById("discountValue").addEventListener("input", calculateFinal);
document.getElementById("discountType").addEventListener("change", calculateFinal);

</script>

</body>
</html>
